<tool id="chewbbaca_allelecall" name="chewBBACA AlleleCall" version="@TOOL_VERSION@+galaxy0">
    <description>BSR-Based Allele Calling Algorithm</description>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">chewbbaca</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        chewBBACA.py AlleleCall
          --cpu \${GALAXY_SLOTS:-1}
          -i '${assembly}'
          #if str( prodigal_training_file_source.prodigal_training_file_source_selector ) == 'tool_data_table'
            --ptf '${prodigal_training_file_source.prodigal_training_file.fields.path}'
          #elif str( prodigal_training_file_source.prodigal_training_file_source_selector ) == 'history'
            --ptf '${prodigal_training_file_source.prodigal_training_file}'
          #end if
          --min_bsr '${min_bsr}'
          --st '${size_threshold}'
        ]]>
    </command>
    <inputs>
        <conditional name="prodigal_training_file_source">
            <param name="prodigal_training_file_source_selector" type="select"
                   label="Select a Prodigal training file from your history or use one from a tool data table?">
                <option value="No" selected="true">No Prodigal training file</option>
                <option value="tool_data_table">Prodigal training file from tool data table</option>
                <option value="history">Prodigal training file from history</option>
            </param>
            <when value="No"/>
            <when value="tool_data_table">
                <param name="prodigal_training_file" type="select" format="tabular" label="Prodigal Training File">
                    <options from_data_table="chewbbaca_prodigal_training_files">
                        <validator type="no_options" message="No chewBBACA prodigal training files are available" />
                    </options>
                </param>
            </when>
            <when value="history">
                <param name="prodigal_training_file" type="data" format="binary"
                       label="Prodigal training file"
                       help=""/>
            </when>
        </conditional>
        <conditional name="schema_source">
            <param name="schema_source_selector" type="select"
                   label="Select a schema from your history or use one from a tool data table?">
                <option value="tool_data_table">Schema from tool data table</option>
                <option value="history">Schema from history</option>
            </param>
            <when value="tool_data_table">
                <param name="chewbbaca_schemas" type="select" label="chewBBACA Schemas">
                    <options from_data_table="chewbbaca_schemas">
                        <validator type="no_options" message="No chewBBACA Schemas Available." />
                    </options>
                </param>
            </when>
            <when value="history">
                <param name="schema" type="data_collection" format="fasta" label="chewBBACA Schema" />
            </when>
        </conditional>
        <param name="assembly" format="fasta" type="data" label="Genome assembly (fasta)" />
        <param name="min_bsr" type="float" value="0.6" optional="true" label="minimum BSR score" />
        <param name="size_threshold" type="float" min="0.0" value="0.2" max="1.0" optional="true" label="Size threshold" />
    </inputs>
    <outputs>
        <data name="statistics" format="tabular" label="${tool.name}: on ${on_string}: Statistics" />
        <data name="contigs_info" format="tabular" label="${tool.name}: on ${on_string}: Contigs Info" />
        <data name="alleles" format="tabular" label="${tool.name}: on ${on_string}: Alleles"  />
        <data name="log" format="txt" label="${tool.name}: on ${on_string}: Log" />
        <data name="repeated_loci" format="tabular" label="${tool.name}: on ${on_string}: Repeated Loci" />
    </outputs>
    <tests>
        
    </tests>
    <help><![CDATA[
    ]]>
    </help>
    <citations>
        <citation type="bibtex">
            @ARTICLE{andrews_s,
                author = {Rossi, M and Silva, M and Ribeiro-Gonçalves, B and Silva, DN
                          and Machado, MP and Oleastro, M and Borges, V and Isidro, J
                          and Gomes, JP and Vieira, L and Barker, DOR and Llarena, AK
                          and Halkilahti, J and Jaakkonen, A and Palma, F and Culebro, A
                          and Kivistö, R and Hänninen, ML and Laukkanen-Ninios, R
                          and Fredriksson-Ahomaa, M and Salmenlinna, S and Hakkinen, M
                          and Garaizer, J and Bikandi, J and Hilbert, F and Taboada, EN
                          and Carriço, JA},
                keywords = {bioinformatics, ngs, mlst},
                title = {{INNUENDO whole and core genome MLST databases and schemas
                          for foodborne pathogens}},
                url = {https://github.com/TheInnuendoProject/chewBBACA_schemas}
            }
        </citation>
      <citation type="doi">10.1099/mgen.0.000166</citation>
      <citation type="doi">10.1371/journal.pgen.1007261</citation>
    </citations>
</tool>
